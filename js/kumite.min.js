$(document).ready(function(){d();var e,a,i=null,t={categoria:"",minuto:0,segundo:0,aka:0,ao:0,senshu:"",C1_AKA:"",C1_AO:"",C2_AKA:"",C2_AO:"",kiken:"",shikkaku:"",kashi:""},o=[],n=[];function r(){$(".grp-btn").prop("disabled",!1)}function c(e){var a;hora=(a=new Date,new Intl.DateTimeFormat("es-VE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(a).replace(/\//g,"-").replace(",","")),console.log(hora+": "+e),logminuto=t.minuto<10?"0"+t.minuto:t.minuto,logsegundo=t.segundo<10?"0"+t.segundo:t.segundo,""!=t.senshu&&(logsenshu="senshu: "+t.senshu),$("#consola").append($("<div><b>"+e+":</b> "+logminuto+":"+logsegundo+" | AO: "+t.ao+" - AKA: "+t.aka+" | "+logsenshu+" "+hora+" </div>"))}function d(){$("button").prop("disabled",!0),$("select").prop("disabled",!0),$("#consola").text(""),$("#minute").text("00"),$("#second").text("00"),$("#AO-PTN").text("00"),$("#AKA-PTN").text("00"),$("#categoria").prop("disabled",!1),$("#categoria").focus(),n=[],o=[]}function u(){t.segundo--,-1==t.segundo&&(t.segundo=59,t.minuto--,-1==t.minuto&&(t.minuto=e)),l()}function l(){$("#minute").text(t.minuto<10?"0"+t.minuto:t.minuto),$("#second").text(t.segundo<10?"0"+t.segundo:t.segundo)}function p(e,a,i){""==t.senshu&&(s=e+"-SENSHU",$("#"+a+"-SENSHU").prop("disabled",!0),$("#"+e+"-SENSHU").attr("id",e+"-SENSHU REVOKE").text("").text(s),t.senshu=s),t[e.toLowerCase()]=0,$.each(i,function(a,i){t[e.toLowerCase()]=parseInt(t[e.toLowerCase()])+parseInt(i),mostrar=t[e.toLowerCase()]<10?"0"+t[e.toLowerCase()]:t[e.toLowerCase()],$("#"+e+"-PTN").text(mostrar)}),console.log(e+": "+t[e.toLowerCase()])}function h(e){id=e.attr("id"),valor=e.val(),t[id]=valor}$("#categoria").change(function(){var i=$(this).val();$(this).attr("id");switch(i){case"Junior":t.categoria="Junior",t.minuto=2,t.segundo=0;break;case"Cadete":t.categoria="Cadete",t.minuto=2,t.segundo=0;break;case"Sub-21":t.categoria="Sub-21",t.minuto=3,t.segundo=0;break;case"Senior":t.categoria="Senior",t.minuto=3,t.segundo=0;break;case"Libre":t.categoria="Libre",t.minuto=1,t.segundo=30;break;default:return void d()}$.each(t,function(e,a){console.log("Pizarra: "+e+": "+t[e])}),t,e=t.minuto,a=t.segundo,l(),$("#START").prop("disabled",!1),$(".tiempo").prop("disabled",!1),$(".amonestacion").prop("disabled",!1),$(".descalificacion").prop("disabled",!1),$("#consola").text("")}),$("button").click(function(){$(this).val();c($(this).attr("id"))}),$("select").change(function(){var e=$(this).val();c($(this).attr("id")+" "+e)}),$("#START").click(function(){(""==!t.kiken||""==!t.shikkaku?(alertify.alert("KASHI","Fin del Combate, Ganador: "+t.kashi),$("#YAME").prop("disabled",!1),0):"4"==t.C1_AO||"4"==t.C2_AO?(t.kashi="AKA No Kashi",alertify.alert("KASHI",t.kashi),0):"4"!=t.C1_AKA&&"4"!=t.C2_AKA||(t.kashi="AO No Kashi",alertify.alert("KASHI",t.kashi),0))&&($("#categoria").prop("disabled",!0),$(".puntos").prop("disabled",!1),"Comenzar"==$(this).val()?($(".grp-btn").prop("disabled",!0),$(this).text(""),$(this).append('<i class="far fa-stop-circle ">Detener</i>').removeClass("btn-success").addClass("btn-warning").val("Detener"),i=setInterval(function(){u(),0==t.segundo&&0==t.minuto&&($("#START").prop("disabled",!0),clearInterval(i),r(),c("FIN DEL TIEMPO DE COMBATE"))},1e3)):(clearInterval(i),r(),$(this).text("").append('<i class="far fa-play-circle ">Comenzar</i>').removeClass("btn-warning").addClass("btn-success").val("Comenzar")))}),$("#RESET").click(function(){$(".puntos").prop("disabled",!0),$("#minute").text(e<10?"0"+e:e),$("#second").text(a<10?"0"+a:a),$("#START").text("").append('<i class="far fa-play-circle ">Comenzar</i>').removeClass("btn-warning").addClass("btn-success").val("Comenzar").prop("disabled",!1),t.minuto=e,t.segundo=a}),$(".tiempo").click(function(){switch($(this).attr("id")){case"-min":t.minuto--,-1==t.minuto&&(t.minuto=e),l();break;case"-seg":u();break;case"+min":t.minuto++,t.minuto>e&&(t.minuto=0),l();break;case"+seg":t.segundo++,60==t.segundo&&(t.segundo=0,t.minuto++,t.minuto>e&&(t.minuto=0)),l()}}),$(".puntos").click(function(){id=$(this).prop("id"),valor=$(this).val(),!id.indexOf("AO")&&id.indexOf("UNDO")<0&&(n.push(valor),p("AO","AKA",n)),!id.indexOf("AKA")&&id.indexOf("UNDO")<0&&(o.push(valor),p("AKA","AO",o)),!id.indexOf("AO")&&id.indexOf("UNDO")>0&&(n.pop(),t.ao=0,$.each(n,function(e,a){console.log("AO: "+e+"= "+a),t.ao=parseInt(t.ao)+parseInt(a)}),mostrar=t.ao<10?"0"+t.ao:t.ao,$("#AO-PTN").text(mostrar)),!id.indexOf("AKA")&&id.indexOf("UNDO")>0&&(o.pop(),t.aka=0,$.each(o,function(e,a){console.log("AKA: "+e+"= "+a),t.aka=parseInt(t.aka)+parseInt(a)}),mostrar=t.aka<10?"0"+t.aka:t.aka,$("#AKA-PTN").text(mostrar))}),$(".senshu").click(function(){$(this).val();var e=$(this).attr("id");if(e==$(this).text()+" REVOKE")$(this).text(""),$(this).append('<i class="fas fa-check"></i>'),$(this).attr("id",t.senshu),$(".senshu").prop("disabled",!1),t.senshu="";else{switch(e){case"AO-SENSHU":$("#AKA-SENSHU").text(""),$("#AKA-SENSHU").append('<i class="fas fa-check"></i>'),$("#AKA-SENSHU").prop("disabled",!0),$(this).attr("id",e+" REVOKE");break;case"AKA-SENSHU":$("#AO-SENSHU").text(""),$("#AO-SENSHU").append('<i class="fas fa-check"></i>'),$("#AO-SENSHU").prop("disabled",!0),$(this).attr("id",e+" REVOKE")}$(this).text(e),t.senshu=e}}),$(".amonestacion").change(function(){h($(this))}),$(".descalificacion").click(function(){if(""==!t.kiken||""==!t.shikkaku)t.kiken="",t.shikkaku="",t.kashi="",$(".descalificacion").prop("disabled",!1);else switch(h($(this)),$(".descalificacion").prop("disabled",!0),$(this).prop("disabled",!1),alertify.success("KASHI: "+$(this).val().split("-")[0]),$(this).val().split("-")[0]){case"AO":t.kashi="AKA NO KASHI";break;case"AKA":t.kashi="AO NO KASHI"}}),$("#YAME").click(function(){d()})});